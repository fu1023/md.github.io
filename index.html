<!doctype html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width,initial-scale=1" />
	<title>在线 Markdown 编辑器（支持坚果云 WebDAV）</title>
	<link rel="stylesheet" href="styles.css">
	<meta name="description" content="在线 Markdown 编辑器：编辑、预览、保存并上传到坚果云（WebDAV）" />
	<style>
		/* 小样式，确保控件布局 */
		.controls button{margin-right:6px}
		.modal{position:fixed;left:0;top:0;right:0;bottom:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.4)}
		.modal[aria-hidden="true"]{display:none}
		.modal-content{background:#fff;padding:16px;border-radius:6px;max-width:480px;width:100%}
	</style>
</head>
<body>
	<header class="topbar">
		<div class="title">在线 Markdown 编辑器</div>
		<div class="controls">
			<button id="newBtn" title="新建">新建</button>
			<input id="configFileInputMain" type="file" accept="application/json" style="display:none" />
			<button id="loadConfigBtn" title="从 config.json 加载">加载 config.json</button>
			<button id="webdavSettingsBtn" title="WebDAV 设置">WebDAV 设置</button>
			<button id="saveWebdavBtn" title="保存到坚果云">保存到坚果云</button>
			<button id="listWebdavBtn" title="显示坚果云文件列表">显示文件列表</button>
			<input id="openFileInput" type="file" accept=".md,text/markdown" style="display:none" />
			<button id="openBtn" title="打开本地文件">打开</button>
			<button id="saveBtn" title="下载为 .md 文件">下载(.md)</button>
			<button id="gistBtn" title="保存到 GitHub Gist">保存为 Gist</button>
			<button id="clearBtn" title="清空编辑器">清空</button>
			<button id="togglePreviewBtn" title="切换预览">切换预览</button>
		</div>
	</header>

	<main class="editor-area">
		<section class="pane left">
			<textarea id="editor" placeholder="在这里输入 Markdown…" style="width:100%;height:70vh"></textarea>
		</section>
		<section class="pane right" id="preview" aria-live="polite" style="padding:12px"></section>
	</main>

	<footer class="footer">
		<div class="status"><span id="status">已就绪</span></div>
		<div class="actions">自动保存：<span id="autosave">开启（localStorage）</span></div>
	</footer>

	<!-- Hidden modal for Gist token/description -->
	<div id="gistModal" class="modal" aria-hidden="true">
		<div class="modal-content">
			<h3>保存为 GitHub Gist</h3>
			<label>Personal Access Token (可选):</label>
			<input id="gistToken" placeholder="输入或粘贴 GitHub PAT（gist 权限）" />
			<label>描述（可选）</label>
			<input id="gistDesc" placeholder="Gist 描述（选填）" />
			<label><input type="checkbox" id="gistPublic" checked /> 公共 Gist</label>
			<div class="modal-actions">
				<button id="createGistBtn">创建 Gist</button>
				<button id="cancelGistBtn">取消</button>
			</div>
		</div>
	</div>

	<!-- WebDAV settings modal (from which config.json could be generated) -->
	<div id="webdavModal" class="modal" aria-hidden="true">
		<div class="modal-content">
			<h3>WebDAV 设置（坚果云）</h3>
			<label>WebDAV 服务器 URL</label>
			<input id="webdavUrl" placeholder="例如: https://dav.jianguoyun.com/dav/" />
			<label>用户名（通常为邮箱）</label>
			<input id="webdavUser" placeholder="你的坚果云用户名/邮箱" />
			<label>密码 / WebDAV 密码</label>
			<input id="webdavPass" type="password" placeholder="WebDAV 密码" />
			<label>保存目录（远程路径，相对于 WebDAV 根，示例：/Documents/notes）</label>
			<input id="webdavFolder" placeholder="/" />
			<label><input type="checkbox" id="webdavRemember" /> 记住服务器地址与用户名（不建议保存密码）</label>
			<div class="modal-actions">
				<button id="webdavSaveSettingsBtn">保存设置</button>
				<button id="webdavCancelBtn">取消</button>
			</div>
		</div>
	</div>

	<!-- Libraries -->
	<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
	<script src="script.js"></script>
</body>
</html>

